package com.matilda5g.cep.fusionEngine;

import com.matilda5g.cep.fusionEngine.Netdata;
import com.matilda5g.cep.fusionEngine.PrometheusAlerts;
import com.matilda5g.cep.fusionEngine.PrometheusData;

declare Netdata
    @role( event )
end

rule "Average CPU over 10%"
    when
        #conditions
        Number ($cpuUsage : doubleValue, doubleValue > 10)
        from accumulate ( Netdata ($cpu : cpuUsagePerc, $memUsage : memUsagePerc)
        from entry-point Netdata, average($cpu))
    then
        #actions
        System.out.println("Average CPU usage over 10%");
end

rule "Average Memory over 1%"
    when
        #conditions
        Number ($memUsage : doubleValue, doubleValue > 1)
        from accumulate ( Netdata ($mem : memUsagePerc, $cpuUsage : cpuUsagePerc)
        from entry-point Netdata, average($mem))
    then
        #actions
        System.out.println("Average Memory usage over 1%");
end

